<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.mybatisplus.dao.EmployeesDao">

    <!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="com.example.mybatisplus.entity.EmployeesEntity" id="employeesMap">
        <result property="employeeId" column="employee_id"/>
        <result property="firstName" column="first_name"/>
        <result property="lastName" column="last_name"/>
        <result property="email" column="email"/>
        <result property="phoneNumber" column="phone_number"/>
        <result property="jobId" column="job_id"/>
        <result property="salary" column="salary"/>
        <result property="commissionPct" column="commission_pct"/>
        <result property="managerId" column="manager_id"/>
        <result property="departmentId" column="department_id"/>
        <result property="hiredate" column="hiredate"/>
    </resultMap>

    <resultMap id="EmpAndDeptNameMap" type="com.example.mybatisplus.vo.EmpAndDeptVo">
        <result column="employee_id" property="employeeId"/>
        <result column="department_id" property="departmentId"/>
        <result column="last_name" property="lastName"/>
        <result column="department_name" property="departmentName"/>
    </resultMap>

    <select id="getEmpNameAndDept" resultMap="EmpAndDeptNameMap">
        select e.employee_id,
               e.last_name,
               d.department_id,
               d.department_name
        from employees e
                 join
             departments d
             on
                 e.department_id = d.department_id
    </select>
    <select id="getSalarySum" resultType="java.lang.Double">
        select sum(salary)
        from employees
    </select>
    <select id="getSalaryMax" resultType="java.lang.Double">
        select max(salary)
        from employees
    </select>
    <select id="deptAndSalaryAvg" resultType="com.example.mybatisplus.vo.DeptAvgVo">
        select e.department_id as departmentId,
               d.department_name as departmentName,
               avg(e.salary) as salaryAvg
        from employees e
                 join departments d on d.department_id = e.department_id
        group by e.department_id
    </select>
    <!--非等值连接：查询员工的姓名、工资、工资等级-->
    <select id="notEqPage" resultType="com.example.mybatisplus.entity.vo.EmpNameAndSalaryAndGradeLevelVo">
        select e.last_name as lastName,
               e.salary as salary,
               jg.grade_level as gradeLevel
        from employees e,
             job_grades jg
        where e.salary between jg.lowest_sal and jg.highest_sal
        order by jg.grade_level asc
    </select>
    <select id="epPage" resultType="com.example.mybatisplus.entity.vo.EmpNameAndDeptNameVo">
        select e.last_name as lastName,
               d.department_name as departmentName
        from employees e,
             departments d
        where e.department_id = d.department_id
    </select>
    <select id="epPage2" resultType="com.example.mybatisplus.entity.vo.EmpNameAndJobIdAndJobTitleVo">
        select e.last_name, j.job_id, j.job_title
        from employees e,
             jobs j
        where e.job_id = j.job_id
    </select>
    <select id="epPage3" resultType="com.example.mybatisplus.entity.vo.EmpNameAndDeptNameVo">
        select e.last_name,d.department_name
        from employees e,departments d
        where e.department_id=d.department_id and e.commission_pct is not null
    </select>
    <select id="selectParamsOne" resultType="com.example.mybatisplus.entity.EmployeesEntity">
        select *
        from employees
        where employee_id = #{id}
    </select>
    <select id="selectParamsMapOne" resultType="com.example.mybatisplus.entity.EmployeesEntity">
        select *
        from employees e
        where e.employee_id=#{map.employeeId} and last_name=#{map.lastName}
    </select>
    <select id="selectParamsCollect" resultType="com.example.mybatisplus.entity.EmployeesEntity">
        select *
        from employees
        where employee_id in (#{ids[0]}, #{ids[1]},#{ids[2]})
    </select>
    <select id="selectCityDeptCount" resultType="com.example.mybatisplus.entity.vo.CityDeptCountVo">
        select l.city as `city`, count(d.department_id) as `countDeptNum`
        from locations l,
             departments d
        where l.location_id = d.location_id
        group by l.city
    </select>


</mapper>